{% extends "base.html" if 'user' not in session else "student/base_student.html" %}

{% block content %}
<h1>Welcome to Magpie Learning</h1>
<p>Explore our courses and start learning today!</p>

<div id="course-grid" class="course-grid">
    {% for course in courses %}
        <div class="course-card">
            <h2>{{ course.course_name }}</h2>
            <p>Instructor: {{ course.course_instructor }}</p>
            <p>Rating: {{ course.average_rating }}★</p>
            <p>Duration: {{ course.course_duration }} hours</p>
            <p>Price: ${{ course.course_price }}</p>
               <a href="{{ url_for('student.course_details', course_id=course.id) }}" class="btn">View Course</a>
        </div>
    {% endfor %}
</div>

<button id="load-more" class="btn">Load More</button>

<script>
let offset = 6;
document.getElementById('load-more').addEventListener('click', function() {
    fetch(`/load_more_courses/${offset}`)
        .then(response => response.json())
        .then(data => {
            const courseGrid = document.getElementById('course-grid');
            data.forEach(course => {
                const courseCard = document.createElement('div');
                courseCard.className = 'course-card';
                courseCard.innerHTML = `
                    <h2>${course.course_name}</h2>
                    <p>Instructor: ${course.course_instructor}</p>
                    <p>Rating: ${course.average_rating}★</p>
                    <p>Duration: ${course.course_duration} hours</p>
                    <p>Price: $${course.course_price}</p>
                    <a href="/course/${course.id}" class="btn">View Course</a>
                `;
                courseGrid.appendChild(courseCard);
            });
            offset += 6;
            if (data.length < 6) {
                this.style.display = 'none';
            }
        });
});
</script>
{% endblock %}