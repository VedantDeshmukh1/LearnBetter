{% extends "teacher/base_teacher.html" %}
{% block content %}
<h2>Edit Course</h2>
<form method="POST">
    <label for="course_name">Course Name:</label>
    <input type="text" id="course_name" name="course_name" value="{{ course.course_name }}" required><br>

    <label for="course_duration">Course Duration (hours):</label>
    <input type="number" id="course_duration" name="course_duration" value="{{ course.course_duration }}" required><br>

    <label for="course_price">Course Price ($):</label>
    <input type="number" id="course_price" name="course_price" value="{{ course.course_price }}" step="0.01" required><br>

    <input type="submit" value="Update Course">
</form>

<h3>Videos:</h3>
<ul id="video-list" class="list-group">
{% for video_id, video in course.videos.items() %}
    <li class="list-group-item" data-id="{{ video_id }}">
        <span class="handle">â˜°</span>
        {{ video.title }} ({{ video.duration }} minutes)
        <a href="{{ url_for('teacher.edit_video', course_id=course.id, video_id=video_id) }}" class="btn btn-sm btn-primary">Edit</a>
        <a href="{{ url_for('teacher.delete_video', course_id=course.id, video_id=video_id) }}" class="btn btn-sm btn-danger">Delete</a>
    </li>
{% endfor %}
</ul>
<a href="{{ url_for('teacher.add_video', course_id=course.id) }}" class="btn btn-success mt-3">Add New Video</a>
<a href="{{ url_for('teacher.dashboard') }}" class="btn btn-secondary mt-3">Back to Dashboard</a>

<form id="reorder-form" method="POST">
    <input type="hidden" name="video_order" id="video-order">
    <button type="submit" class="btn btn-primary mt-3">Save Video Order</button>
</form>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var el = document.getElementById('video-list');
    var sortable = Sortable.create(el, {
        handle: '.handle',
        animation: 150,
    });

    document.getElementById('reorder-form').addEventListener('submit', function(e) {
        var videoOrder = sortable.toArray();
        document.getElementById('video-order').value = videoOrder.join(',');
    });
});
</script>
{% endblock %}